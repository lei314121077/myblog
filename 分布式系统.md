##  案例1
### 体系结构
   这个系统设计有三个独立进程。输入进程，控制进程，和输出进程。输入和输出进程由控制进程产生，和控制。三者的基本功能为：
   * 输入进程。采集数据，将数据存储，并通知控制进程有需要处理的新数据。
   * 控制进程。控制输入与输出进程的生命周期。系统信息的接受，和发出控制指令，以及处理返回结果等。系统错误处理，例如终结无响应进程，对不可恢复错误进行报错等。
   * 输出进程。在接到控制程序指令后传输，和返回传输结果给主程序。
   > 这些进程间通信使用系统的IPC。当输入有输入是通知控制进程，控制进程转达给输出进程。完全分离输入和输出单位。输出的结果和错误处理由控制进程完成。
   * 这样做的原因是：
      * 一）分离功能和分离可控和不可控的模块。尤其是输出进程的通讯部分牵涉与远程计算单元的网络通讯，应当和主控制系统分离。
      * 二）提高整体系统与环境交互的响应。控制进程完全使用非等待式的I/O处理。这个进程的运算以发送控制信令为主，要短暂，一个功能不可阻塞其它功能。
      * 三）安全考虑。控制进程可能需要一些特权权限。而其它进程则可以在提权限用户下执行。控制进程只接受本系统内的输入于输出，降低受外部使用输入攻击的风险。
      * 四）系统的恢复与纠错。控制进程可以终结和创建其它类型的进程。可以在一定情况下自我恢复。
      * 五）独立日志。控制进程的日志与其它进程分离提供一定的安全和维护便利。
### 输出的远程通讯
   可以有多重方案。
   * 一）文件复制。将数据存入文件复制到远程机器指定的目录。由远程的程序决定如何处理。时效性低，磁盘输入输出昂贵，运行环境允许这样的操作。不关心远程立即执行。
   * 二）使用有复制和同步功能的数据库。
   * 三）写程序进行数据传输。
   
   原题中比较关心的实际上是远程数据传输的控制部分
   > 值得指出的是，这个控制和选择的通讯方案无关。通讯方案负责的数据的传输，而控制是本系统最终是否接受了这几传输的结果。
   
      * 数据的识别。首先，数据要唯一标识符。
      * 数据传输的状态。其次，要有一个处理状态图，待处理，发出未响应，已处理，放弃（要报警）。如果原题重的a和b需要同时接受成功为成功否则为失败，则增加了状态机的复杂度。而原题中关心的返回值应该就是状态或是简化的状态值。
      * 传输的控制。传输的控制由控制进程完成。根据不同的状态设计操作。这些操作和状态图形成了一个有限状态机。
      * 错误处理。传输错误是可以重试。仍热失败是要报警寻求人工干预。重试的限度和报警方式和系统是否中断运行取决于失败传输数据是否是其它系统的输入和影响度。重试发出方和接受方要考虑double ack的问题。
